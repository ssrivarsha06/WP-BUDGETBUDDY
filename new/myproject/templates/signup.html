<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Signup Page</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&family=Poppins&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            font-family: "Poppins", serif;
            background-image: linear-gradient(to bottom, #0D1321, #1D2D44);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        /* Main container */
        .container {
            display: flex;
            width: 1200px;
            height: 800px;
            background-color: #3e5c76;
            border-radius: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        /* Left Section */
        .container .left-section {
            flex: 1;
            margin-left: 20px;
            margin-top: 20px;
            margin-bottom: 20px;
            border-radius: 20px;
            background-color: white;
        }

        /* Right Section */
        .container .right-section {
            flex: 1;
            padding: 90px;
            color: #e4e9f2;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        h3 {
            font-size: 50px;
            font-family: "Poppins", serif;
            margin-bottom: 20px;
            text-align: left;
        }

        p {
            font-size: rem;
            margin-bottom: 20px;
        }

        a {
            color: #1fbf73;
            text-decoration: none;
        }

        .name-fields {
            display: flex;
            flex-direction: column;
        }

        input {
            background-color: #6c8397;
            border: 3px solid #6c8398;
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 15px;
            color: white;
        }

        input::placeholder {
            color: #1D2D44;
        }

        /* Password field with toggle icon */
        .password-field {
            position: relative;
        }

        .toggle-password {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
        }

        /* Checkbox */
        .checkbox {
            display: flex;
            align-items: center;
            font-size: 14px;
        }

        .checkbox input {
            width: auto;
            margin-right: 8px;
        }

        /* Buttons */
        .create-account {
            background-color: #D8fd49;
            color: rgb(0, 0, 0);
            width: 100%;
            border: none;
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            align-items: center;
            margin-bottom: none;
        }

        .create-account:hover {
            background-color: #17a661;
        }

        /* Google Sign-in */
        .google-signin {
            width: 100%;
            padding: 10px;
            background: transparent;
            border: 1px solid black;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 5px;
        }

        .google-signin img {
            width: 20px;
        }

        hr {
            border: 0;
            height: 1px;
            background: #b0bec5;
            margin: 20px 0;
        }

        .divider {
            display: flex;
            align-items: center;
            margin: 20px 0;
        }

        .divider::before,
        .divider::after {
            content: "";
            flex: 1;
            height: 1px;
            background-color: #6b7280;
        }

        .divider span {
            margin: 0 10px;
            font-size: 0.85rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                width: 90%;
            }

            .left-section {
                display: none;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="left-section">
            <img src="{{ url_for('static', filename='login.jpg') }}" alt="login" style=" width: fit-content; height:max-content;">
        </div>
        <div class="right-section">
            <h3>Create an Account</h3>
            <p>Already have an account? <a href="/">Login</a></p>

            <form id="signupForm">
                <div class="name-fields">
                    <input type="text" id="firstName" placeholder="First name" required>
                    <input type="text" id="lastName" placeholder="Last name" required>
                </div>

                <div class="name-fields">
                    <input type="email" id="email" placeholder="Email Address" required>
                </div>

                <div class="name-fields">
                    <input type="password" id="password" placeholder="Password" required>
                    <span class="toggle-password" onclick="togglePassword()">üëÅÔ∏è</span>
                </div>

                <div class="checkbox">
                    <input type="checkbox" id="terms">
                    <label for="terms">I agree to the <a href="#">Terms & Conditions</a></label>
                </div>

                <button type="submit" class="create-account">Create Account</button>
            </form>

            <script>
                document.getElementById("signupForm").addEventListener("submit", function (event) {
                    event.preventDefault();

                    let firstName = document.getElementById("firstName").value.trim();
                    let lastName = document.getElementById("lastName").value.trim();
                    let email = document.getElementById("email").value.trim();
                    let password = document.getElementById("password").value.trim();
                    let termsChecked = document.getElementById("terms").checked;

                    // Send data to backend
                    fetch('/signup', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            firstName: firstName,
                            lastName: lastName,
                            email: email,
                            password: password
                        })
                    })
                        .then(response => response.json())
                        .then(data => {
                            if (response.ok) {
                                alert("Account created successfully!");
                                window.location.href = "/"; // Redirect to login page
                            } else {
                                alert(data.message || "Signup failed."); // Display error message
                            }
                        })
                        .catch(error => {
                            console.error('Error:', error);
                            //alert('An error occurred during signup.');
                            window.location.href = "/login";
                        });
                });

                // Function to toggle password visibility
                function togglePassword() {
                    let passwordField = document.getElementById("password");
                    passwordField.type = (passwordField.type === "password") ? "text" : "password";
                }
            </script>

            <div class="divider">
                <span>or</span>
            </div>
            <button id="googleSignIn" class="google-signin">
              <img src="https://www.google.com/favicon.ico" alt="Google icon">
              Sign in with Google
          </button>
            <!-- Google Sign-In SDK -->
            <script src="https://accounts.google.com/gsi/client" async defer></script>
            <!-- Google Sign-Up Button -->
            <div id="g_id_onload" data-client_id="YOUR_GOOGLE_CLIENT_ID" data-context="signup" data-ux_mode="popup"
                data-callback="handleCredentialResponse" data-auto_prompt="false">
            </div>

            <script>
                function handleCredentialResponse(response) {
                    console.log("Google JWT Token:", response.credential);

                    // Send the token to your backend for verification
                    fetch('/google-signup', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            token: response.credential
                        })
                    })
                        .then(response => response.json())
                        .then(data => {
                            console.log("Backend Response:", data);
                            if (response.ok) {
                                localStorage.setItem('access_token', data.access_token); // Store the token
                                window.location.href = "landing.html"; // Redirect to landing page
                            } else {
                                alert(data.message || "Login failed."); // Display error message
                            }

                        })
                        .catch(error => console.error("Error:", error));
                }
            </script>
        </div>
    </div>
</body>

</html>


